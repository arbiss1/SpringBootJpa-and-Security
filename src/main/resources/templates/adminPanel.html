<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
      xmlns:th="http://www.thymeleaf.org">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="https://use.fontawesome.com/your-embed-code.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
      integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <style>
      .centerDiv {
  width: 40%;
  height: 50%;
  background: white;
  border : solid 2px lighblue ;
  border-radius : 8px ;
  padding :50px;
  margin-top : 5%;
  }
  body {
  height : auto;
  background-color:lightgray ;
  }
  .saveButton {
  width:100%;
  margin-top: 20px;
  }
  .selectNew {
  width:100%;
  border: solid 2px lightgray;
    padding: 5px;
    border-radius: 5px;
  }
  table {
  margin-top:20px;
  width:100%;
  }
  .hiddenDiv{
   display:none;
   margin-top:10px;
  }
     @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap");

:root {
    --header-height: 3rem;
    --nav-width: 68px;
    --first-color: #4723D9;
    --first-color-light: #AFA5D9;
    --white-color: #F7F6FB;
    --body-font: 'Nunito', sans-serif;
    --normal-font-size: 1rem;
    --z-fixed: 100
}

*,
::before,
::after {
    box-sizing: border-box
}

body {
    position: relative;
    margin: var(--header-height) 0 0 0;
    padding: 0 1rem;
    font-family: var(--body-font);
    font-size: var(--normal-font-size);
    transition: .5s
}

a {
    text-decoration: none
}

.header {
    width: 100%;
    height: var(--header-height);
    position: fixed;
    top: 0;
    left: 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 1rem;
    background-color: lightgray;
    z-index: var(--z-fixed);
    transition: .5s
}

.header_toggle {
    color: var(--first-color);
    font-size: 1.5rem;
    cursor: pointer
}

.header_img {
    width: 35px;
    height: 35px;
    display: flex;
    justify-content: center;
    border-radius: 50%;
    overflow: hidden
}

.header_img img {
    width: 40px
}

.l-navbar {
    position: fixed;
    top: 0;
    left: -30%;
    width: var(--nav-width);
    height: 100vh;
    background-color: var(--first-color);
    padding: .5rem 1rem 0 0;
    transition: .5s;
    z-index: var(--z-fixed)
}

.nav {
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    overflow: hidden
}

.nav_logo,
.nav_link {
    display: grid;
    grid-template-columns: max-content max-content;
    align-items: center;
    column-gap: 1rem;
    padding: .5rem 0 .5rem 1.5rem
}

.nav_logo {
    margin-bottom: 2rem
}

.nav_logo-icon {
    font-size: 1.25rem;
    color: var(--white-color)
}

.nav_logo-name {
    color: var(--white-color);
    font-weight: 700
}

.nav_link {
    position: relative;
    color: var(--first-color-light);
    margin-bottom: 1.5rem;
    transition: .3s
}

.nav_link:hover {
    color: var(--white-color)
}

.nav_icon {
    font-size: 1.25rem
}

.show {
    left: 0
}

.body-pd {
    padding-left: calc(var(--nav-width) + 1rem)
}

.active {
    color: var(--white-color)
}

.active::before {
    content: '';
    position: absolute;
    left: 0;
    width: 2px;
    height: 32px;
    background-color: var(--white-color)
}

.height-100 {
    height: 100vh
}

@media screen and (min-width: 768px) {
    body {
        margin: calc(var(--header-height) + 1rem) 0 0 0;
        padding-left: calc(var(--nav-width) + 2rem)
    }

    .header {
        height: calc(var(--header-height) + 1rem);
        padding: 0 2rem 0 calc(var(--nav-width) + 2rem)
    }

    .header_img {
        width: 40px;
        height: 40px
    }

    .header_img img {
        width: 45px
    }

    .l-navbar {
        left: 0;
        padding: 1rem 1rem 0 0
    }

    .show {
        width: calc(var(--nav-width) + 156px)
    }

    .body-pd {
        padding-left: calc(var(--nav-width) + 188px)
    }
}
i {
font-size: 23px;
color: white;
}
    .aAncor{
    color: lightgray;
    font-weight: 100;
    }
.divNav{
background-color:darkslateblue;}
  </style>
</head>
<body>
<div th:insert="/navbarFragment :: navbar"></div>
<main>
  <div class="container text-center centerDiv">
    <h1 style = "font-size:24px;">Admin functionalities</h1>
    <span th:id = "message"></span>
    <span style = "color:red;" th:if="${nonUniqueUsername}" th:text = "${nonUniqueUsername}"></span>
    <br />
    <form id="myform" th:action = "@{/process_registerAdmin}"
          method="post" >
      <button class = "btn btn-secondary saveButton" th:onclick = "category()" th:id = "button"  type="submit">Add new admin</button>
      <div th:id = "divHidden" class = "hiddenDiv">
        <input style = "margin-bottom: 5px;"  class="form-control" th:field = "*{user.username}" id="credintials1"  type="text" required placeholder="Username..."/>
        <input style = "margin-bottom: 5px;"  class="form-control" th:field = "*{user.first_name}" id="credintials2"  type="text" required placeholder="First Name..."/>
        <input style = "margin-bottom: 5px;"   class="form-control" th:field = "*{user.lastName}" id="credintials3"   type="text" required placeholder="Last Name..."/>
        <input style = "margin-bottom: 5px;"  class="form-control" th:field = "*{user.password}"   type="text" th:id ="password" required placeholder="Password..."/>
        <input style = "margin-bottom: 5px;"  class="form-control" th:field = "*{user.MatchingPassword}" th:id = "passwordConfirm"   type="text" required placeholder="Confirm Password..."/>
        <input style = "margin-bottom: 5px;"   class="form-control" th:field = "*{user.user_address}"   type="text" requi\red placeholder="Address..."/>
        <input style = "margin-bottom: 5px;"   class="form-control" th:field = "*{user.user_number}"   type="text" required placeholder="Phone Number..."/>
        <button class = "btn btn-primary saveButton" th:id = "submit" type="submit">Save</button>
      </div>
    </form>
    <form >
      <button th:onclick = "category1()" class = "btn btn-secondary saveButton" type="button" th:id = "button1" >Show all users</button>
    </form>
    <div th:id = "divHidden1" class = "hiddenDiv">
    <table border="1" cellpadding="10" class="table">
      <thead class="thead-dark">
      <tr scope = "row">
<!--        <th scope ="col">Username</th>-->
        <th scope ="col">First Name</th>
        <th scope ="col">Last Name</th>
        <th scope ="col">Role</th>
        <th scope="col" sec:authorize = "hasAuthority('ADMIN')">Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr scope="row" th:each="allUsers: ${users}">
<!--        <td th:text="${allUsers.username}">Username<\td>-->
        <td th:text="${allUsers.first_name}">First Name <\td>
        <td th:text="${allUsers.lastName}">Last Name <\td>
        <td th:text="${allUsers.roles}">Role <\td>
        <td>
          <div sec:authorize = "hasAnyAuthority('USER','ADMIN')">
            <a sec:authorize = "hasAuthority('ADMIN')" th:href="@{'/delete-user-admin/' + ${allUsers.userId}}" th:onclick="confirmAction()">Delete</a>
          </div>
        </td>
        </td>
      </tr>
      </tbody>
    </table>
    </div>
        <form>
            <button th:onclick = "category2()" class = "btn btn-secondary saveButton" type="button" th:id = "button2" >Show product requests</button>
        </form>
        <div th:id = "divHidden2" class = "hiddenDiv">
            <table border="1" cellpadding="10" class="table">
                <thead class="thead-dark">
                <tr scope = "row">
                    <!--        <th scope ="col">Username</th>-->
                    <th scope ="col">Product Requested</th>
                    <th scope ="col">Requested by</th>
                    <th scope="col" sec:authorize = "hasAuthority('ADMIN')">Actions</th>
                </tr>
                </thead>
                <tbody>
                <tr scope="row" th:each="allProducts: ${productRequests}">
                    <!--        <td th:text="${allUsers.username}">Username<\td>-->
                    <td th:text="${allProducts.product}">Product Requested <\td>
                    <td th:text="${allProducts.userRequestedId}">Requested by <\td>
                    <td>
                        <div sec:authorize = "hasAnyAuthority('USER','ADMIN')">
                            <a sec:authorize = "hasAuthority('ADMIN')"  th:onclick="confirmAction()">Approve</a>
                            <a sec:authorize = "hasAuthority('ADMIN')"  th:onclick="confirmAction()">Delete</a>
                        </div>
                    </td>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
  </div>
</main>
<script>
  function category(){
   var div = document.getElementById("divHidden");
   var button = document.getElementById("button");
   if(div.style.display === "none"){
   div.style.display = "block";
   button.setAttribute("style" ,"background-color:red;");
   }else
   {
    div.style.display = "none"
    button.setAttribute("style" ,"background-color:gray;");
   }
   }
   function category1(){
   var div = document.getElementById("divHidden1");
   var button = document.getElementById("button1");
   if(div.style.display === "none"){
   div.style.display = "block";
   button.setAttribute("style" ,"background-color:red;");
   }else
   {
    div.style.display = "none"
    button.setAttribute("style" ,"background-color:gray;");
   }
   }
   function category2(){
   var div = document.getElementById("divHidden2");
   var button = document.getElementById("button2");
   if(div.style.display === "none"){
   div.style.display = "block";
   button.setAttribute("style" ,"background-color:red;");
   }else
   {
    div.style.display = "none"
    button.setAttribute("style" ,"background-color:gray;");
   }
   }
</script>
   <script>
        $(function () {
        $("#submit").click(function () {
            var password = $("#password").val();
            var confirmPassword = $("#passwordConfirm").val();
            var message =  $("#message");
            if (password != confirmPassword) {
                 message.html("Password don't match !").css('color','red');
                return false;
            }
            return true;
        });
    })

     document.addEventListener("DOMContentLoaded", function(event) {

const showNavbar = (toggleId, navId, bodyId, headerId) =>{
const toggle = document.getElementById(toggleId),
nav = document.getElementById(navId),
bodypd = document.getElementById(bodyId),
headerpd = document.getElementById(headerId)

if(toggle && nav && bodypd && headerpd){
toggle.addEventListener('click', ()=>{
nav.classList.toggle('show')
toggle.classList.toggle('bx-x')
bodypd.classList.toggle('body-pd')
headerpd.classList.toggle('body-pd')
})
}
}

showNavbar('header-toggle','nav-bar','body-pd','header')

const linkColor = document.querySelectorAll('.nav_link')

function colorLink(){
if(linkColor){
linkColor.forEach(l=> l.classList.remove('active'))
this.classList.add('active')
}
}
linkColor.forEach(l=> l.addEventListener('click', colorLink))

});
   </script>
</body>
</html>